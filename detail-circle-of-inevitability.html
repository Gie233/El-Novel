<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lord of Mysteries: Circle of Inevitability | El-Novel</title>
  <link rel="stylesheet" href="Styles/Style.css" />
</head>
<body>
  <header>
    <a href="index.html" class="logo">El-Novel</a>
    <nav class="nav-center">
      <a href="index.html">Home</a>
      <a href="novels.html" class="active">Novels</a>
      <a href="explore.html">Explore</a>
      <a href="joinUs.html" >Join Us</a>
    </nav>
    <div class="theme-toggle">
      <input type="checkbox" id="mode-switch">
      <label for="mode-switch" class="switch"></label>
    </div>
  </header>

  <main class="novel-detail">
    <div class="detail-container">
      <div class="detail-content">
        <div class="detail-cover">
          <img src="Library/circle.jpg" alt="Lord of Mysteries: Circle of Inevitability">
        </div>

        <div class="detail-info">
          <h2>Lord of Mysteries: Circle of Inevitability</h2>
          <p class="author"><strong>Author:</strong> Cuttlefish That Loves Diving</p>
          <div class="rating">‚òÖ4.3/5</div>
          <p><strong>Genre:</strong> Fantasy, Mystery, Action, Psychological</p>

          <p class="desc">Legenda The Fool berlanjut saat dunia memasuki siklus takdir berikutnya. Para Beyonder baru mulai bangkit, para dewa kembali bergelora, dan rahasia-rahasia alam semesta mulai muncul ke permukaan. Ketika sejarah terus berulang dalam lingkaran yang tak dapat dipatahkan, satu pertanyaan tetap tersisa: siapa yang mampu menantang takdir itu sendiri?</p>

          <div class="review-box">
            <h3>Reviewer‚Äôs Thoughts</h3>
            <p>Sebuah sekuel yang sempurna‚Äîmemperdalam lore sekaligus mempertahankan misteri dan ketegangan dari pendahulunya. Kompleks, menggugah pemikiran, dan ditulis dengan sangat indah.</p>
          </div>

          <!--     NO PV PLACEHOLDER      -->
          <section class="novel-pv no-pv">
            <h3>Promotional Video</h3>

            <div class="pv-placeholder">
              <span>üé¨ Promotional video is not available for this novel.</span>
            </div>
          </section>

          <div class="detail-buttons">
            <a href="Novels.html" class="btn-small">‚Üê Back to Novels</a>
            <a href="https://lordofthemysteries.fandom.com/wiki/Circle_of_Inevitability_(Novel)" class="btn-small">More Info</a>
          </div>
        </div>
      </div>
    </div>
  </main>
  <footer>
    <p>¬© 2025 El-Novel. All rights reserved.</p>
    <div class="footer-links">
      <a href="AboutUs.html">About Us</a> 
    </div>
  </footer>
  <script>
    const switchToggle = document.getElementById("mode-switch");
    switchToggle.addEventListener("change", () => {
      document.body.classList.toggle("light-mode", switchToggle.checked);
    });
    const modeSwitch = document.getElementById("mode-switch");

// Ambil mode dari localStorage
const savedMode = localStorage.getItem("theme");
if (savedMode === "light") {
  document.body.classList.add("light-mode");
  modeSwitch.checked = true;
}

// Ketika switch diubah
modeSwitch.addEventListener("change", () => {
  if (modeSwitch.checked) {
    document.body.classList.add("light-mode");
    localStorage.setItem("theme", "light");
  } else {
    document.body.classList.remove("light-mode");
    localStorage.setItem("theme", "dark");
  }
});

// VISIT COUNTER FOR NOVEL DETAIL

function trackNovelVisit() {
    const titleElement = document.querySelector("h2");
    if (!titleElement) return; // stop if not a detail page

    const novelTitle = titleElement.innerText;
    const today = new Date().toISOString().slice(0, 10);

    const now = new Date();
    const weekKey = `${now.getFullYear()}-W${Math.ceil(now.getDate() / 7)}`;
    const monthKey = `${now.getFullYear()}-${now.getMonth() + 1}`;

    function load(key, def) {
        return JSON.parse(localStorage.getItem(key)) || def;
    }
    function save(key, data) {
        localStorage.setItem(key, JSON.stringify(data));
    }

    // === DAILY ===
    let daily = load("dailyVisits", {});
    let dailyDate = localStorage.getItem("dailyDate");
    if (dailyDate !== today) {
        daily = {};
        localStorage.setItem("dailyDate", today);
    }
    daily[novelTitle] = (daily[novelTitle] || 0) + 1;
    save("dailyVisits", daily);

    // === WEEKLY ===
    let weekly = load("weeklyVisits", {});
    let weeklyDate = localStorage.getItem("weeklyStart");
    if (weeklyDate !== weekKey) {
        weekly = {};
        localStorage.setItem("weeklyStart", weekKey);
    }
    weekly[novelTitle] = (weekly[novelTitle] || 0) + 1;
    save("weeklyVisits", weekly);

    // === MONTHLY ===
    let monthly = load("monthlyVisits", {});
    let monthlyDate = localStorage.getItem("monthlyStart");
    if (monthlyDate !== monthKey) {
        monthly = {};
        localStorage.setItem("monthlyStart", monthKey);
    }
    monthly[novelTitle] = (monthly[novelTitle] || 0) + 1;
    save("monthlyVisits", monthly);
}

// RANKING PAGE ‚Äî LOAD DATA
function loadRanking(type, containerId = "rankingList") {
    const container = document.getElementById(containerId);
    if (!container) return;

    const data = JSON.parse(localStorage.getItem(type + "Visits")) || {};
    const sorted = Object.entries(data).sort((a, b) => b[1] - a[1]);

    container.innerHTML = "";

    if (sorted.length === 0) {
        container.innerHTML = "<li style='text-align:center;'>Belum ada data.</li>";
        return;
    }

    sorted.forEach(([title, count], i) => {
        container.innerHTML += `
            <li>
                <span class="rank-num">${i + 1}</span>
                <span class="rank-title">${title}</span>
                <span style="float:right;color:gray;">${count} views</span>
            </li>
        `;
    });
}

  </script>
</body>
</html>
